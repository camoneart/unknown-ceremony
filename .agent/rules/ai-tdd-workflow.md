---
trigger: model_decision
description: AI駆動開発におけるTDD（テスト駆動開発）のワークフローとルール。ユーザーが「TDD」「テスト駆動」「AI駆動開発」について言及した時、または複雑なロジックを含む機能実装を行う際に適用する。
---

# AI駆動TDD開発ルール

このルールは、AI（Gemini）を用いた開発（AI駆動開発）において、テスト駆動開発（TDD）を適用し、確実かつ迅速に機能を実装するための指針です。

## 適用タイミング

- 新しい機能の実装を開始する時
- ユーザーが「TDD」「テスト駆動」「AI駆動開発」について言及した時
- 複雑なロジックを含むコンポーネントや関数を実装する時

## 基本哲学

**「AIに『考えさせる』のではなく、AIに『合格基準（テスト）』を与える」**

AI（Gemini）は、明確なゴール（テスト）が与えられれば、迷わず最短距離で実装を完了させることができます。ユーザーは仕様と境界条件を決定し、AIはそれを満たす実装に専念します。

## 開発ワークフロー

以下のステップに従って開発を進めます。

### 1. ブランチ作成 (Branching)
機能実装ごとの独立性を保つため、作業用のブランチを作成します。
- 命名規則: `feat/機能名` や `fix/バグ名` など

### 2. テスト作成 (Test First)
**実装コードを書く前に、まずテストコードを作成します。**
- ユーザーと協力して、機能の要件（仕様）をテストケースとして定義します。
- 正常系だけでなく、異常系や境界値のテストも網羅します。
- この時点ではテストは失敗（Red）します。
- 必要に応じて、AIがテストコードの雛形やケースを提案します。

### 3. 実装 (AI Implementation)
作成したテストが通るように、AIがプロダクションコードを実装します。
- 指示: 「このテストファイルが通るまで実装して」
- AIはテストを実行し、エラー内容を確認しながら修正を繰り返します（Red -> Green）。
- **注意**: テストコード自体を修正して無理やり通すことは禁止です（仕様変更の場合を除く）。

### 4. リファクタリング (Refactoring)
テストが通った後、コードの可読性や保守性を高めるためのリファクタリングを行います。
- テストが通っている状態を維持しながら行います（Green -> Refactor）。

### 5. レビューとマージ (Review & Merge)
- 全てのテストが通過していることを確認します。
- ローカルでの動作確認を行います。
- 問題なければPRを作成し、マージします。

## Geminiの役割

- **実装者**: 与えられたテスト（ゴール）に向かって、自律的にコードを書き、修正し、完成させます。
- **提案者**: テストケースの漏れや、より良い設計があれば積極的に提案します。
- **パートナー**: ユーザーと共に「堅牢なコード」を作り上げるための伴走者です。

## 合言葉

「テストというゴールをください。最短で実装します！」